Редакция от 2025-03-04
Набор функций, которые могут быть полезными при работе с bdeal.

Использование: Сохранить файл в папку с Вашими скриптами, затем в начале скрипта добавить dofile("bdeal_functions.lua")

Функции в библиотеке:
tricks_correction(contract, tricks_taken) - пытается получить коррекцию за розыгрыш и вист человеками. За основу взято соотношение от Ричарда Павличека. 
Выдает 0 или +-1 для каждой сдачи, то есть, результат надо прибавить к результату функции tricks основнойпрограммы и затем отправить в count.
Использовать надо аккуратно, у меня есть большие сомнения в генераторе случайных чисел (см. текст примечаний в функции) и иногда она будет давать очевидный бред:
Если у севера будет 13 пик, то в контракте 7п она иногда будет давать отрицательную коррекцию. Также, чем сильнее зафиксированы руки, тем меньше на нее можно полагаться

 have_stopper(N:S()) - возвращает true если у севера есть задержка в пике
 have_cuebid(N:S()) - возвращает true если у севера есть кюбид любого класса в пике
 
 total_points(level, -- Уровень контракта (1 - 7)
						suit, -- Масть (C, D, H, S, NT)
						tricks, -- Взято взяток (0- 13)
						vul, -- до зоны (false) или в зоне (true), если опустить - то до зоны
						doubled, -- Была ли контра true/false, можно опустить
						redoubled -- Была ли реконтра true/false, можно опустить
						) - подсчет тотальных пунктов
						
total_to_imp(delta) - перевод тотальных пунктов в импы

suit_losers(N:S()) - Подсчет потерь в масти. В основном, для служебных нужд

LTC(hand, correction) - подсчет потерь в руке, correction - использовать ли коррекцию. Пока либо ничего (не использовать параметр), либо "R" для Рубенса. Пример вызова: LTC(S, "R")

LTC_tricks(hand, correction) - Количество взяток пары с точки зрения теории потерь. correction - использовать ли коррекцию. 
Пока либо ничего (не использовать параметр), либо "R" для Рубенса. Пример вызова: LTC_tricks(S, "R")

best_fit(hand) - Поиск лучшего фита для пары. Возвращает длину фита и список мастей. 
Пример вызова: n, suits = best_fit(W). 
На выходе: n = 8, suits = {"S", "D"} - в пике и бубне восьмикартные фиты. Функция гарантирует, что будет соблюдено обычное старшинство мастей в списке фитов - пика-черва-буна-трефа
